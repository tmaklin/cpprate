// cpprate: Variable Selection in Black Box Methods with RelATive cEntrality (RATE) Measures
// https://github.com/tmaklin/cpprate
// Copyright (c) 2023 Tommi MÃ¤klin (tommi@maklin.fi)
//
// BSD-3-Clause license
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are
// met:
//
//     (1) Redistributions of source code must retain the above copyright
//     notice, this list of conditions and the following disclaimer.
//
//     (2) Redistributions in binary form must reproduce the above copyright
//     notice, this list of conditions and the following disclaimer in
//     the documentation and/or other materials provided with the
//     distribution.
//
//     (3)The name of the author may not be used to
//     endorse or promote products derived from this software without
//     specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
// IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
// INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
// IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.
//
#ifndef CPPRATE_CPPRATERES_TEST_HPP
#define CPPRATE_CPPRATERES_TEST_HPP

#include <cstddef>
#include <vector>

#include "gtest/gtest.h"

// Integration test for cpprate
//
class CppRateResTest : public ::testing::Test {
  protected:
    void SetUp() override {
	// Parameters
	this->n_design_dim = 20;
	this->n_f_draws = 100;
	this->n_obs = 10;

	// Input data
	this->design_matrix = { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
				0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,
				1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,
				0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,
				0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,
				0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
				0,0,1,1,0,1,0,0,1,0,0,0,1,0,0,0,0,0,1,0,
				0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,
				0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,
				0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0 };
	this->f_draws = { -6.73547458213277,-0.300263985541422,-6.81470954432113,6.94318986278777,-5.44896509510378,-2.5366205703406,-1.24844768934632,8.77513237360593,-3.62467053670517,-0.489010242924885,
			  -6.81121711079486,0.998915389057232,-4.38573784402282,8.82734941393486,-4.43614826756895,-4.01327768662203,-1.41498699340357,9.53057970875737,-1.77382997040734,-1.1475687354857,
			  -11.262934255259,-0.810164429016605,-3.40483312131745,8.10505900545574,-4.75122561242841,-3.43652095823485,-0.580339883818108,6.73559624918973,-2.7181468122588,-1.68706486889551,
			  -7.18460544796125,0.411101506842434,-3.69836773990994,8.44999767869517,-6.19478559245962,-3.43603443271895,-0.80173053102948,9.35368080747247,-1.9153097506837,0.224677487797558,
			  -7.42536987603256,1.50389646565577,-3.55626309786152,7.80104807516072,-4.45218140243174,-3.19603759692659,-0.355626346493957,8.28956802601565,-2.02399614991911,-2.68261749993927,
			  -7.71118634134793,0.676919555436972,-3.89185759172763,7.44322950107747,-4.68826346697533,-2.63157188676209,-0.335024789210033,7.65216066637632,-3.49016988286547,-1.54741692455149,
			  -8.03995476324227,-0.268579997537278,-3.70990399533667,10.0253018445979,-6.67720624861776,-6.04878493365199,-0.991310530996322,8.65406427865356,-2.42517214388806,-1.96657029922516,
			  -8.23888397771089,0.509926787381964,-2.94647721808348,8.3120688118503,-4.67433266414377,-3.59247696278337,0.173545526612154,8.8830859096883,-2.72890118201985,-0.228647393286753,
			  -7.83213338836791,-0.810897719749218,-3.73544267014525,8.27002398114624,-6.2203821898954,-2.72601080527329,0.277786159275511,9.55149054172447,-2.15873870011567,-1.71371025713246,
			  -8.60007892940413,0.107761949222992,-4.91601675070345,9.17454973368119,-5.56926066279546,-2.4644103733495,0.792941196671334,8.51980594729676,-3.03093096496161,1.21317587013578,
			  -8.4238749851835,2.04816837405725,-1.62175571913268,9.29855616335592,-6.1331446240771,-3.63499306746155,2.05511799163502,9.13730918065625,-2.60552442327385,-2.69192849624559,
			  -9.5995334540179,-0.911616398933958,-3.49111691393217,9.37258904160051,-4.84968246560744,-2.98315286300446,-0.956135401022449,10.6037454079519,-4.27966166010779,-0.66248580959639,
			  -7.82477155246524,-0.516789645698781,-3.40979146620616,7.47570753449639,-4.27201222477138,-5.07960651908617,-0.329271769987626,8.56847019152688,-1.19806247939623,-0.888333707578184,
			  -7.97665937994288,-0.193622068496406,-4.05389381556064,8.6165566353229,-5.39891630461526,-3.45529142440548,1.17755212092688,8.74231903264143,-3.01054033195702,-1.74242496571166,
			  -6.94361687222457,-1.86513119976471,-3.01225132343187,10.3431054399987,-4.42086304499882,-2.40902518114314,-1.29646385668623,9.5184991972589,-3.853960927401,-2.58300483167032,
			  -9.42123742882223,-1.42002062562124,-4.41068620009801,8.7760382810633,-5.15091829726779,-3.88694439065688,-1.89967056731167,9.22907532234697,-4.47530828773633,-2.23491688233249,
			  -9.39803628884745,-1.33983291205289,-3.85790176601147,9.97917628697858,-5.74514367302002,-6.03308279864898,-0.386266692266024,10.1615982281319,-3.49334819414277,-0.656713531084458,
			  -10.1661909726279,0.625155678746472,-4.48893389604917,7.27293776935912,-4.44311132604895,-7.06050385623908,0.138892151906723,7.78346865694316,-2.17774392128173,-1.67361064522978,
			  -9.80405501909254,0.82869819635528,-2.66446893823018,8.3865992262248,-3.41544315556409,-1.22708352091626,-1.24398684898768,10.5280012969087,-4.60286031133683,-2.44193509662128,
			  -8.27913825574939,0.587220848573846,-2.0854862732303,7.76086578411509,-4.39829575734499,-4.15168799785145,2.35646931721459,8.64939871612326,-3.674755220729,-2.18974533942523,
			  -8.12333511690693,0.283291812796853,-4.68959334402997,7.16121848290397,-4.36378806475545,-3.95036231080033,-0.983633576237723,9.42747869511366,-3.36859333574084,-2.2126662032603,
			  -7.47535732159545,-0.642910174752912,-2.62890012313538,9.0639830967738,-6.36056302870526,-4.99376281548742,0.669432566849132,8.47947193868778,-1.59795642533064,-1.89221631001722,
			  -7.96460878586186,0.435178445131722,-3.2834194327937,6.64096681091012,-5.29524342703971,-2.53761579806467,-0.672015089648073,7.99664335431368,-2.81071136892509,-1.19359678509643,
			  -8.01064869531377,0.856087863673504,-4.25879204993957,9.27985549084926,-5.51761912298599,-3.87488913145133,-0.0415549686119719,9.56540700374841,-2.54131261172151,-1.37488830756328,
			  -9.62414383613782,0.686572331945818,-4.15857154135951,8.13309428250268,-5.72854023958486,-3.19567821056462,0.349499103566149,5.9335755946641,-3.23854145228238,-2.87885844479073,
			  -9.64951454568365,0.492087997054664,-3.509863604877,6.64899615149859,-6.7751822843734,-6.59196209441196,1.20573497606954,7.90521700672589,-1.75828255860133,-0.109976480149243,
			  -8.54284609587024,-1.93188551351571,-3.90944805444785,7.95800442568459,-5.08109041463254,-4.24341479899939,-1.20534652663729,7.60443899652531,-3.31910406309969,-0.968843241897904,
			  -8.35963833198398,1.84927359392299,-5.32503923230809,8.68996184695166,-5.04132555868765,-6.16255664335793,-0.0432116713285828,9.01324546135903,-1.71399933761104,-2.52365268064629,
			  -8.16528409508592,-0.478618708478723,-2.73166446812264,8.61400439573847,-4.42894107666852,-4.54380589821518,0.900726361118607,7.71146128837565,-1.56567443847898,0.29319600732247,
			  -6.86259638471967,1.07601281550838,-2.51943936580931,7.58537495952486,-5.11809973663673,-5.14090196075309,-1.67754205605507,7.66795407523482,-1.72263303718251,-0.825040105553593,
			  -7.56958566408279,-1.55801147482336,-4.78294670992509,8.16739562439798,-4.66959051738059,-3.09209604884898,-0.642347429770996,8.46478671326643,-3.66833261466607,-2.13157506283179,
			  -7.07952533316105,0.383312043774486,-4.55419077780727,8.93424382513575,-5.19753783383349,-4.72857510412071,-1.23745521491091,7.91620253678152,-2.60165551832967,-2.15475298393857,
			  -7.44167519045584,-0.612062425971596,-3.69825323456155,10.0352979416387,-4.75244324261732,-4.60723451752368,-1.60853770550557,8.92040979381036,-2.00396948975288,-2.1344065784154,
			  -8.42641888023765,1.56870872688097,-3.47602353448392,8.42059311335488,-4.7431367241909,-3.65682092881721,-0.304603353766509,8.83362552471935,-1.63756751094161,0.541287641852998,
			  -8.85833067719863,-2.02689931789878,-4.61428662430993,9.71298322928006,-4.12050013720944,-2.81907806601561,0.296179959558497,9.11816251134571,-2.9957957807499,-1.97895260502359,
			  -7.32028364098823,1.00496004240818,-2.93389098397772,9.87100489071915,-6.2559999642646,-4.81512307846087,1.95760832842923,6.58940312982806,-2.08628185249003,-1.12962373508743,
			  -8.89945004805696,-1.56512988738363,-2.11949704630227,10.6149324419629,-6.40985149326872,-4.42866723803191,-1.89270332640354,9.06447116621196,-2.54858778169807,-0.754922497432813,
			  -6.70098784279356,-0.327390830801168,-4.54563285937597,7.37829270106081,-5.87175730412969,-3.27568043862357,0.285587234757797,9.70637286163723,-2.26190023146392,-2.18438385528561,
			  -8.25077189749296,-0.46537420356065,-5.63431269310118,6.7007305777919,-4.99634920997263,-4.19653813425869,-0.0884493711996349,8.69986842343325,-1.97911787936973,-1.63747012312203,
			  -5.59823117890053,-0.934777823602583,-2.86574830503972,7.37125677925353,-2.35306670530865,-3.92287621510898,0.470257687673675,9.60061133387152,-1.56167027309081,-0.451502036075558,
			  -8.96514530337018,-0.774380681689025,-4.09290401684309,7.59830443216785,-7.48689940176302,-3.82596400157762,-0.373932731314759,10.0522437543681,-1.08071243237054,-2.21711074983377,
			  -7.24383034920484,0.457737964377537,-3.15777512780505,8.14033587417589,-6.18125126366166,-2.4833854806486,-0.886695939875846,8.96241327100089,-3.46779053718137,0.109858574624932,
			  -5.96232581955443,0.484267367670058,-3.19081120982071,7.64997751030948,-4.82174825330661,-4.49438442748874,-0.899659398981922,9.85584381740381,-5.43821310250935,-1.02700287072494,
			  -6.66764085308926,0.568251329452562,-3.57713043708985,11.3502658761489,-4.34819639650459,-5.40118070172923,-0.632421345920192,9.33913646440156,-1.73291132453883,-0.110268297070596,
			  -7.36742710849262,-0.772253891566379,-4.40485345517429,8.07835542132137,-6.6295119854865,-4.33884202668686,-0.429490036292798,9.90235176932215,-3.71289258564055,0.012013646911712,
			  -7.12745837223298,-0.424541231190692,-5.39659799779607,9.73168574533252,-6.6412444124488,-3.20036406369664,-0.938506063564527,6.7759849299817,-2.21407763579736,0.365242080276623,
			  -9.0308724476995,0.141637296923665,-3.78791318460528,9.01478812037977,-3.69582008873901,-4.50493717297693,-0.529591712247864,9.44674408559133,-1.35568195917569,-1.78432053756739,
			  -10.0137522558452,0.547324519004524,-3.26197528882737,6.46928134747538,-4.42754388815695,-4.68478576784196,0.168424624837695,8.83373695674929,-3.65977870270156,-1.71835427593158,
			  -6.32785735865175,-0.665588291977814,-3.44165697923693,6.36722328130987,-4.31679685798269,-4.50300657456381,0.214305211021733,10.2258347449813,-3.3173485994862,-0.5962310177045,
			  -10.0800571948969,0.440121928126289,-3.57018083320968,7.8168089044562,-6.09317488844121,-4.22352637146442,0.0686588170783416,9.91335526844985,-2.12642515470793,-0.652271445499048,
			  -5.25170066226124,0.64418327905306,-4.7991584269962,9.42885688250979,-4.37551937679465,-3.63829042116599,-1.42504812911678,9.07888470988358,-2.25730590597918,0.174174711396046,
			  -7.30521776974686,-0.0474758384828119,-5.92766181579151,6.65874600738482,-4.84815046636847,-4.80045959375144,-0.650149721283366,10.8067679683642,-3.46560675439642,-0.467943100903515,
			  -7.0082855945731,0.0786490994153827,-3.63445871253626,8.21923027490698,-5.29753466214166,-2.66691090028838,-2.16661601341159,7.68587237240697,-1.62770343975497,-2.03033276564432,
			  -5.82955411140246,0.328814580143923,-3.96456103218641,10.0814549452484,-6.22263790810133,-4.76979398489753,0.0594708758660472,8.49726730704965,-0.595563814636188,-1.84962051594304,
			  -8.86220621676383,-2.09005591245504,-3.89811830826603,8.81780176727217,-5.36796675311138,-2.40428918832165,-0.0960970126034026,11.2775362004959,-1.5202243357932,-0.175472765730101,
			  -7.50116175414039,-1.83635496757947,-3.14099011531955,7.81534687352204,-4.03406580886016,-3.29572953223845,0.308962358365492,8.99437210507069,-2.75059329867142,-1.20413203178382,
			  -7.8089208474507,-1.4630616744322,-4.54779929139304,7.81289316658046,-4.99245493877343,-5.16457323248979,1.48070657104382,9.30602288606873,-2.41195724908914,-0.747377564193131,
			  -8.15290404290716,2.39865897229638,-3.51964739056379,10.4020260473646,-4.45039165728873,-4.5929488957831,-1.62553614058629,9.75102667697881,-2.43510670296487,-1.24814824380887,
			  -7.61764907951161,-1.40877179609202,-4.3987502858666,7.99300670323774,-4.4851475722254,-2.54971463086518,-1.65737884290182,10.2842970579209,-3.345311989305,-1.46678506693482,
			  -6.9729960266329,-0.866171147611734,-3.66393926734356,7.51762887765254,-6.01703157022628,-4.42163581412321,-0.634937706934717,9.9007628409984,-2.40085231332794,-1.53685256229713,
			  -7.58979729034705,-0.411932589903625,-5.1289844521241,8.70536647893505,-5.76840433628518,-4.20683589311562,-0.756348301869077,8.85171929747348,-5.76721107668329,-0.627823955137088,
			  -8.91113511954649,-0.346530684209406,-3.82496590905199,7.69953882262067,-6.08671351991342,-4.0842752852991,-1.06497341527198,8.78080377029104,-2.32725604868839,-0.0848521899982522,
			  -8.2861611586094,-0.649807155750468,-4.25073758181415,7.06877020420774,-3.54348965109184,-2.57057212984276,0.0572698275381159,8.49837163641549,-2.97580220740161,-0.89267307740774,
			  -9.02139393428003,-0.234380149035932,-3.72267482439957,8.3038359212208,-5.74288982432295,-4.52955271546239,-1.50471061337777,9.20008541012083,-3.12812371109687,-0.758700139253588,
			  -6.73035899318426,0.603764068931288,-3.32017371422742,8.10296077503879,-4.42387728445852,-3.71048365088539,-1.35970822983911,8.2154013736644,-3.9922919314321,-2.29413928582887,
			  -7.92125337515567,-1.13639321954203,-2.22827566149023,8.69405990871262,-5.46391737491763,-4.24976197032967,1.52321550994131,10.1472014139064,-1.12847213162909,-2.20069053453918,
			  -8.65557703288185,0.00878321147419582,-5.99298186824395,9.23022780521305,-4.50726608435735,-4.99403623536499,0.900361291294057,8.35129566787828,-2.00938606294333,-1.8564926643872,
			  -8.01143023174295,0.172880464830976,-3.24244132303678,8.33035096835676,-5.73872705936749,-2.43536212472317,1.99337966997579,9.88798391469967,-3.60428539725936,-1.1513452446957,
			  -7.08053828538639,-1.38745359591809,-3.61401167976106,8.77783453532865,-3.4820248081304,-4.73589930009675,-0.513978899474451,7.45759957880426,-1.864904105301,-2.51741726301119,
			  -8.36839995408138,-1.05951732171848,-3.46990044334151,8.47157365551674,-4.5412479242409,-4.20793377786821,-0.568737441618642,10.00350753772,-2.18971236722735,-0.229813526004511,
			  -8.13980286102473,-0.612431442190555,-3.41821411207087,9.25275740620337,-4.61216512189627,-4.33841706649141,-0.861965619881899,6.94994101613835,-3.97199056679625,-1.21552007740638,
			  -6.67838075330651,-1.51129788803131,-3.20431333289674,8.71771290401048,-4.86865091731151,-4.52545309788984,0.733914781655638,8.17315726103543,-3.17394172056184,-1.85111627155778,
			  -8.76458460027659,1.08265385442885,-2.86013853140988,8.78987302698738,-5.20238130131828,-4.87027478836341,-0.914537530765042,8.52529094027972,-2.03901505757839,-1.33744157440247,
			  -7.93474747213012,2.39775593513979,-4.78939462752427,9.21843472806285,-5.13825572910859,-4.01215678688559,-0.320443504853683,9.39935470153349,-3.89317158524778,-1.05956014234145,
			  -7.81244321744293,-0.610334485159577,-4.65003045536218,8.68983533031733,-5.35601439789761,-5.02340978063261,-0.0982768428491813,10.3283829423435,-2.96236166577385,-1.72623093110891,
			  -6.8585214195656,-0.411004287782794,-4.43017966043943,8.29609651669644,-5.99484719200418,-4.62341298284563,1.99656892161552,8.66248019865916,-2.51597815049746,-1.44263275735853,
			  -6.75257321750977,-0.296626511019321,-5.1385326984773,8.78711392129352,-4.50697445962657,-3.34046274050122,-0.173451091244495,7.99337861510504,-1.53075936851245,-1.42846638429673,
			  -6.94198885812699,-0.798555595059907,-2.6757909372964,9.70633925068056,-4.15980926182616,-3.13934075514573,0.0974666091388215,7.2892681347252,-4.27574601662799,-2.21086386824889,
			  -7.76458778395803,-0.717757662880755,-3.86041849646296,9.53299093197364,-4.713404203369,-5.39517526828556,-0.308516460551183,9.11047033855408,-1.02250422618792,-1.09662195057177,
			  -8.37284701993591,-1.273391214806,-2.90693494166971,9.72741647520181,-5.12746799403193,-5.16338633492384,0.188581262080357,6.76629301770505,-3.58372248063905,-1.47255724944967,
			  -8.36872858540188,-0.184144136406493,-4.40902172564164,9.06164080967947,-5.55974074460273,-4.30986120915408,0.178119179559627,9.58006653357951,-1.22755204162142,-2.49026944482244,
			  -7.23622498951099,-0.96023277262944,-3.20173312370427,7.66198986237773,-4.63003104614801,-4.1920538214646,1.56933938086658,9.93490159625351,-2.00034327047101,0.245995918900533,
			  -7.89948884988887,1.20151282219269,-4.79132113176763,8.05415265609404,-4.48314450405031,-3.37954357321204,0.277820912516352,9.61400643975065,-3.44905752961165,-0.110180215147973,
			  -7.30693940024504,0.96405680747379,-4.32989246516653,8.18949435053579,-5.84647753169126,-3.74980357489348,-0.981357813926935,8.61232892529763,-1.89425698340093,-2.98745317589956,
			  -7.3616735699824,0.907756754527362,-4.32486367838385,8.89862864378946,-6.14240197326206,-2.73186257659278,0.484690558283143,9.37572925068601,-2.88312051790372,-1.27654576452665,
			  -9.5014234490802,-0.013636647210515,-1.953979573892,7.14309679511572,-3.99752621369654,-3.41815985414386,-1.99924890435916,7.03347848873572,-3.1029602244354,0.646393574910985,
			  -6.80142479701945,-0.0613511520954221,-2.34958517442236,7.91930482467772,-4.06240959087083,-5.1815011729939,-0.144756208332792,8.63410081786663,-1.22977931385868,-0.482566025756041,
			  -8.07341801874838,-0.327953180521493,-4.06146601428913,9.10348346717181,-4.74585334503515,-4.97010278462806,-0.486188031089316,9.07662177989339,-2.04996099766975,-1.51549785212585,
			  -8.32771625353111,0.247687216530314,-3.97174948576197,8.61110308664502,-5.97690228599318,-3.81569990930754,-1.31871725280948,6.85460975277952,-2.46615597453519,-1.03150156238744,
			  -8.80151324985168,1.57381416930428,-3.83958926226986,7.13710989488203,-4.67095316500724,-2.73877256101654,-0.893642021298777,9.13391056104506,-2.19888340632346,-0.751399431802071,
			  -6.59780293411598,-1.48143683500582,-3.08214630726115,8.40929135769838,-4.04320522902627,-5.8106939479995,0.490211480603684,8.27680584821406,-2.91513889124954,-0.490808419799687,
			  -6.64774712455701,-0.393582989049232,-3.10990418209433,8.08958605280724,-1.63260025105059,-4.6176179590342,-1.10677049019771,7.70634202965862,-4.05420387043102,-0.632772856036838,
			  -6.2634549454517,0.332746994124367,-5.64924927594095,9.09012670003025,-4.46637003540516,-4.37551854772024,-2.86158854104568,9.76677808254423,-1.47433672391651,2.90993514228545,
			  -7.73413760406898,-0.599106982412199,-3.99517754246961,8.23680656013317,-6.95679496056182,-4.18181097035545,-2.16171645389436,10.8127551052276,-2.97702630279568,-0.177521176415248,
			  -6.998151863674,-0.5037782516005,-2.36631521422807,6.60885654452087,-4.71516197819924,-2.44473178834911,0.178922521447033,10.1747799873246,-2.74073593699798,-0.694142538370626,
			  -7.32525222506493,0.16336673389982,-2.98387896861812,7.89921787898665,-4.20485402287793,-3.72155881952953,0.991945185767405,9.08384858329201,-3.20865808593071,-2.20056523897724,
			  -9.38540962370249,-1.61399303760486,-4.85801719649106,7.32367557223145,-3.07482109039817,-5.30662488840436,-0.0960134744816779,9.251406575123,-2.9996086741383,-1.2146487064817,
			  -9.33682255973776,0.703565385115437,-2.74282672205004,7.25337195483205,-5.0884862953915,-4.87045033355581,-1.4925912816456,8.93573427136695,-1.8015467505682,-1.54109088181852,
			  -9.90160160251689,0.71191842567529,-4.2672694164969,8.74520795962353,-3.39613878709751,-5.97160846028749,0.386374248155131,8.16164839076611,-2.6808737299427,-0.84249110100532,
			  -7.30610433687758,-1.11292889796795,-3.79580179012717,9.13856980899353,-4.78111293832235,-3.11861539671737,0.341072531319388,7.57812149238847,-3.83109100733496,-2.38914445286053 };
    }

    void TearDown() override {
	// this->n_design_dim = 0;
	// this->n_f_draws = 0;
	// this->n_obs = 0;

	// this->design_matrix.clear();
	// this->design_matrix.shrink_to_fit();
	// this->f_draws.clear();
	// this->f_draws.shrink_to_fit();
    }

    // Test parameters
    size_t n_design_dim;
    size_t n_obs;
    size_t n_f_draws;
    std::vector<size_t> invariant_dim_indices;

    // Input values
    std::vector<bool> design_matrix; // 10x`n_design_dims` matrix stored contiguously
    std::vector<double> f_draws; // 10x1 vector
    
    // Expected values
    static std::vector<double> svd_d;
    static std::vector<double> svd_u;
    static std::vector<double> svd_u_dropped;
    static std::vector<double> svd_v_dropped;
    static std::vector<double> svd_v;    
    static size_t num_expected_invariant_dims;
    static std::vector<double> beta_draws_expected;
    static std::vector<double> beta_draws_cov_expected;
    static std::vector<double> f_draws_cov_expected;
    static std::vector<double> project_cov_f_draws_expected;
    static std::vector<double> approximate_cov_beta_expected;
    static std::vector<double> svd_project_cov_f_draws_u;
    static std::vector<double> svd_cov_u_expected;
    static std::vector<double> approximate_beta_means_expected;
    static size_t svd_cov_u_invariant_dims;
    static std::vector<double> col_means_beta_expected;
    static std::vector<double> lambda_expected;
    static std::vector<double> lowrank_lambda_expected;
    static std::vector<double> sherman_r_expected;
    static std::vector<double> expected_KLD;
    static std::vector<double> expected_RATE;
    static double expected_ESS;
    static double expected_Delta;
};
std::vector<double> CppRateResTest::svd_d = { 2.547924, 2.145761, 2.051606, 1.531563, 1.414214, 1.251116, 1.156189, 0.6685457, 0, 0 };
std::vector<double> CppRateResTest::svd_u = { 0,0,0,0,0,0,0,0,0,0,
					      -0.02708703,-0.488972,-0.2047639,-0.3835255,-2.394163e-14,-0.3090962,-0.1098872,-0.6808355,0,0,
					      -0.09722747,-0.1304165,0.304299,0.4478546,-1.045776e-13,-0.6839341,-0.4407665,0.1353726,0,0,
					      -0.01012977,-0.5545557,-0.393245,0.4209023,-3.227899e-15,0.4643097,-0.3589628,0.1269928,0,0,
					      -0.008285284,-0.4006958,-0.2707039,0.1081235,-2.53389e-15,-0.3570526,0.7069234,0.3566169,0,0,
					      0,0,0,0,0,0,0,0,0,0,
					      -0.8878288,0.2433472,-0.3753526,-0.04236565,-8.920466e-13,-0.06704195,-0.06268789,0.0378603,0,0,
					      -0.4367377,-0.3396424,0.6722234,0.1548174,-4.550291e-13,0.2973115,0.2923278,-0.21024,0,0,
					      -0.1032576,-0.3181729,0.2116075,-0.6616054,-1.094064e-13,0.02710943,-0.2750806,0.5737597,0,0,
					      -9.896359e-17,-2.955358e-16,2.74614e-16,-8.384766e-16,1,-6.895913e-15,-1.209058e-15,5.52921e-17,0,0 };
std::vector<double> CppRateResTest::svd_v = { -0.03815949,-0.06077869,0.1483223,0.2924166,-7.391679e-14,-0.546659,-0.3812234,0.2024882,0,0,-0.0178585,-0.6730589,-0.4234306,0.09500116,-2.096033e-14,-0.1613272,0.2059121,-0.2950072,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0.05663084,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0.05663084,0,0,0,0,0,0,0,0,0,0,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0.05663084,0,0,-0.2119354,-0.3065651,0.4307995,-0.3308959,-3.990289e-13,0.2593051,0.01491728,0.5437469,0,0,-0.003975696,-0.2584425,-0.1916766,0.2748187,-2.299518e-15,0.3711163,-0.3104706,0.1899539,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0.05663084,0,0,-0.05115721,-0.3761579,0.003335716,-0.6823948,-9.42908e-14,-0.2253881,-0.3329626,-0.1601624,0,0,-0.1714092,-0.1582853,0.3276571,0.1010845,-3.216791e-13,0.2376369,0.2528373,-0.3144737,0,0,-1.680367e-16,-4.55299e-16,1.225736e-16,-3.476018e-16,0.7071068,-5.538831e-15,-9.224642e-16,-3.637005e-17,0,0,-0.5198611,-0.04487692,0.1447017,0.07342282,-9.524464e-13,0.1840512,0.1986179,-0.2578428,0,0,-0.003975696,-0.2584425,-0.1916766,0.2748187,-2.299518e-15,0.3711163,-0.3104706,0.1899539,0,0,-1.680367e-16,-4.55299e-16,1.225736e-16,-3.476018e-16,0.7071068,-5.538831e-15,-9.224642e-16,-3.637005e-17,0,0,0,0,0,0,0,0,0,0,0,0,-0.003251779,-0.1867383,-0.1319473,0.07059679,-1.738469e-15,-0.2853872,0.6114253,0.5334219,0,0,-0.2095687,-0.219064,0.4759795,0.3935012,-3.956788e-13,-0.3090221,-0.1283862,-0.1119855,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0.05663084,0,0,0,0,0,0,0,0,0,0,0,0 };
std::vector<double> CppRateResTest::svd_u_dropped = { 0,-0.01063102,-0.03815949,-0.003975696,-0.003251779,0,-0.3484518,-0.1714092,-0.04052619,-3.884087e-17,0,-0.2278781,-0.06077869,-0.2584425,-0.1867383,0,0.1134084,-0.1582853,-0.1482798,-1.377301e-16,0,-0.09980662,0.1483223,-0.1916766,-0.1319473,0,-0.1829555,0.3276571,0.1031423,1.338532e-16,0,-0.2504144,0.2924166,0.2748187,0.07059679,0,-0.0276617,0.1010845,-0.4319804,-5.474645e-16,0,-1.692929e-14,-7.394756e-14,-2.282469e-15,-1.791731e-15,0,-6.307722e-13,-3.217542e-13,-7.736201e-14,0.7071068,0,-0.2470563,-0.546659,0.3711163,-0.2853872,0,-0.05358571,0.2376369,0.02166819,-5.511808e-15,0,-0.09504256,-0.3812234,-0.3104706,0.6114253,0,-0.0542194,0.2528373,-0.23792,-1.045726e-15 };
std::vector<double> CppRateResTest::svd_v_dropped = { -0.03815949,-0.06077869,0.1483223,0.2924166,-7.391679e-14,-0.546659,-0.3812234,-0.0178585,-0.6730589,-0.4234306,0.09500116,-2.096033e-14,-0.1613272,0.2059121,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0,0,0,0,0,0,0,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,-0.2119354,-0.3065651,0.4307995,-0.3308959,-3.990289e-13,0.2593051,0.01491728,-0.003975696,-0.2584425,-0.1916766,0.2748187,-2.299518e-15,0.3711163,-0.3104706,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,-0.05115721,-0.3761579,0.003335716,-0.6823948,-9.42908e-14,-0.2253881,-0.3329626,-0.1714092,-0.1582853,0.3276571,0.1010845,-3.216791e-13,0.2376369,0.2528373,-1.680367e-16,-4.55299e-16,1.225736e-16,-3.476018e-16,0.7071068,-5.538831e-15,-9.224642e-16,-0.5198611,-0.04487692,0.1447017,0.07342282,-9.524464e-13,0.1840512,0.1986179,-0.003975696,-0.2584425,-0.1916766,0.2748187,-2.299518e-15,0.3711163,-0.3104706,-1.680367e-16,-4.55299e-16,1.225736e-16,-3.476018e-16,0.7071068,-5.538831e-15,-9.224642e-16,0,0,0,0,0,0,0,-0.003251779,-0.1867383,-0.1319473,0.07059679,-1.738469e-15,-0.2853872,0.6114253,-0.2095687,-0.219064,0.4759795,0.3935012,-3.956788e-13,-0.3090221,-0.1283862,-0.3484518,0.1134084,-0.1829555,-0.0276617,-6.307601e-13,-0.05358571,-0.0542194,0,0,0,0,0,0,0 };
size_t CppRateResTest::num_expected_invariant_dims = 7;
std::vector<double> CppRateResTest::beta_draws_expected = { -6.436511,1.578908,-1.217793,-1.217793,5.716369e-17,-1.217793,-1.745499,2.682141,-1.217793,-1.879172,6.058312,-0.2445051,4.840519,2.682141,-0.2445051,0,-7.027873,-0.3781989,-1.217793,0,-4.912214,2.04175,-1.142279,-1.142279,5.803886e-17,-1.142279,-0.730995,3.3928,-1.142279,-1.042835,5.438689,-0.5737844,4.29641,3.3928,-0.5737844,0,-6.477899,0.5264757,-1.142279,0,-3.728204,0.9890437,-0.7719858,-0.7719858,3.845732e-17,-0.7719858,-0.9189387,3.558008,-0.7719858,-1.799208,4.051575,-0.8435324,3.279589,3.558008,-0.8435324,0,-5.740269,0.3233709,-0.7719858,0,-4.48898,1.343849,-1.013554,-1.013554,5.168561e-17,-1.013554,-0.9825627,3.553075,-1.013554,-0.932747,5.279592,0.1123387,4.266039,3.553075,0.1123387,0,-7.538634,0.7906124,-1.013554,0,-4.254947,2.096392,-0.8848762,-0.8848762,4.327351e-17,-0.8848762,-1.431501,2.852328,-0.8848762,-0.5924952,4.953631,-1.341309,4.068755,2.852328,-1.341309,0,-6.548573,0.6986838,-0.8848762,0,-4.48146,1.988538,-0.9010145,-0.9010145,3.971351e-17,-0.9010145,-2.178551,2.727346,-0.9010145,-1.311619,5.071062,-0.7737085,4.170048,2.727346,-0.7737085,0,-6.676802,0.5896022,-0.9010145,0,-4.355616,1.161063,-0.998773,-0.998773,4.975774e-17,-0.998773,-0.995529,4.432119,-0.998773,-1.429643,5.001327,-0.9832851,4.002554,4.432119,-0.9832851,0,-7.838269,0.6457117,-0.998773,0,-3.987046,1.835127,-0.8090116,-0.8090116,4.14614e-17,-0.8090116,-1.403701,3.238471,-0.8090116,-1.3252,5.027615,-0.1143237,4.218603,3.238471,-0.1143237,0,-6.50946,1.040569,-0.8090116,0,-4.423888,0.791979,-0.8057577,-0.8057577,4.705688e-17,-0.8057577,-0.5558619,3.739022,-0.8057577,-1.602877,5.112333,-0.8568551,4.306575,3.739022,-0.8568551,0,-7.012361,0.688445,-0.8057577,0,-5.095622,1.675488,-0.7470476,-0.7470476,4.040401e-17,-0.7470476,-1.463205,3.749531,-0.7470476,-1.567726,5.275227,0.6065879,4.528179,3.749531,0.6065879,0,-7.244749,0.179605,-0.7470476,0,-3.373883,2.298668,-0.5118155,-0.5118155,2.681251e-17,-0.5118155,-2.355025,3.499944,-0.5118155,-0.2504995,5.126011,-1.345964,4.614195,3.499944,-1.345964,0,-8.431813,1.752128,-0.5118155,0,-4.752173,1.845838,-1.161561,-1.161561,5.658265e-17,-1.161561,-1.522208,3.763376,-1.161561,-2.757454,6.013229,-0.3312429,4.851668,3.763376,-0.3312429,0,-6.69552,1.261056,-1.161561,0,-3.875005,0.8823428,-0.7782482,-0.7782482,4.705862e-17,-0.7782482,0.2010699,3.296682,-0.7782482,-1.399132,4.340218,-0.4441669,3.561969,3.296682,-0.4441669,0,-5.154355,0.4652131,-0.7782482,0,-4.580078,1.475315,-0.6547849,-0.6547849,3.74542e-17,-0.6547849,-1.341603,3.570621,-0.6547849,-1.668938,5.106261,-0.8712125,4.451477,3.570621,-0.8712125,0,-6.874232,0.5261838,-0.6547849,0,-4.056495,1.327806,-1.066201,-1.066201,5.442688e-17,-1.066201,-0.6610236,4.50765,-1.066201,-3.192937,5.10074,-1.291502,4.034539,4.50765,-1.291502,0,-5.748669,1.044244,-1.066201,0,-5.064302,1.464508,-1.269598,-1.269598,5.803512e-17,-1.269598,-1.59078,3.655765,-1.269598,-2.884529,5.717918,-1.117458,4.44832,3.655765,-1.117458,0,-6.615426,0.6536161,-1.269598,0,-4.725901,1.256006,-0.9966946,-0.9966946,5.325988e-17,-0.9966946,-0.8975091,4.361585,-0.9966946,-2.595839,5.593901,-0.3283568,4.597206,4.361585,-0.3283568,0,-7.00115,0.8679997,-0.9966946,0,-4.636344,1.645593,-0.7741437,-0.7741437,4.069515e-17,-0.7741437,-1.157307,2.813673,-0.7741437,-1.020437,4.783754,-0.8368053,4.009611,2.813673,-0.8368053,0,-6.088704,0.1474103,-0.7741437,0,-4.449971,2.949686,-1.246577,-1.246577,5.436056e-17,-1.246577,-2.481872,2.718457,-1.246577,-2.120988,6.235474,-1.220968,4.988897,2.718457,-1.220968,0,-6.365129,1.785503,-1.246577,0,-3.507736,2.058071,-0.4289195,-0.4289195,2.420194e-17,-0.4289195,-2.203905,2.851397,-0.4289195,-1.47085,4.929986,-1.094873,4.501067,2.851397,-1.094873,0,-6.456367,1.42225,-0.4289195,0,-5.257599,1.995023,-1.134873,-1.134873,5.398067e-17,-1.134873,-1.656862,2.583098,-1.134873,-1.711731,5.825604,-1.106333,4.690731,2.583098,-1.106333,0,-6.358811,0.5680055,-1.134873,0,-3.461612,0.6173084,-0.6041485,-0.6041485,3.807553e-17,-0.6041485,-0.3377378,4.223337,-0.6041485,-1.260219,4.294323,-0.9461082,3.690175,4.223337,-0.9461082,0,-6.977871,0.8327116,-0.6041485,0,-4.110266,1.476316,-0.9348546,-0.9348546,4.263913e-17,-0.9348546,-1.769574,2.582326,-0.9348546,-1.041137,4.937113,-0.5967984,4.002258,2.582326,-0.5967984,0,-6.771559,0.8268466,-0.9348546,0,-4.9368,1.997912,-0.9427271,-0.9427271,4.85671e-17,-0.9427271,-1.399488,3.640972,-0.9427271,-1.141824,5.614807,-0.6874442,4.67208,3.640972,-0.6874442,0,-7.515531,0.6780077,-0.9427271,0,-4.275332,1.631508,-0.6737657,-0.6737657,2.85579e-17,-0.6737657,-2.293606,3.250793,-0.6737657,-0.9449357,4.392093,-1.439429,3.718327,3.250793,-1.439429,0,-7.360048,0.1167608,-0.6737657,0,-4.076726,0.874525,-0.5729755,-0.5729755,3.239379e-17,-0.5729755,-1.375846,2.887236,-0.5729755,-0.382437,4.643588,-0.05498824,4.070612,2.887236,-0.05498824,0,-7.649707,0.5668622,-0.5729755,0,-4.20731,0.6352038,-0.9517531,-0.9517531,4.733754e-17,-0.9517531,-0.7520147,3.6614,-0.9517531,-2.567089,4.505172,-0.4844216,3.553419,3.6614,-0.4844216,0,-5.716294,0.2978622,-0.9517531,0,-5.440427,2.282671,-0.9331712,-0.9331712,4.871569e-17,-0.9331712,-1.280602,3.203646,-0.9331712,-0.4333969,5.555815,-1.261826,4.622644,3.203646,-1.261826,0,-7.323996,0.1153881,-0.9331712,0,-3.303986,0.9695122,-0.4959301,-0.4959301,3.400108e-17,-0.4959301,-0.1175435,3.822246,-0.4959301,-1.448131,3.876307,0.146598,3.380377,3.822246,0.146598,0,-5.398453,0.5723212,-0.4959301,0,-3.497865,1.561231,-1.025639,-1.025639,4.646695e-17,-1.025639,-1.237415,3.012072,-1.025639,-0.4852178,4.476291,-0.4125201,3.450652,3.012072,-0.4125201,0,-6.67933,0.9784259,-1.025639,0,-4.950819,1.130024,-0.9601733,-0.9601733,4.924032e-17,-0.9601733,-0.9802969,3.518686,-0.9601733,-2.688036,5.118692,-1.065788,4.158519,3.518686,-1.065788,0,-5.799615,0.1678727,-0.9601733,0,-4.781114,1.699089,-1.040915,-1.040915,4.929295e-17,-1.040915,-1.285879,3.617577,-1.040915,-1.315777,5.008037,-1.077376,3.967121,3.617577,-1.077376,0,-6.896627,0.226923,-1.040915,0,-4.235555,1.292868,-1.063566,-1.063566,5.620463e-17,-1.063566,-0.09903889,4.371215,-1.063566,-1.904931,4.772856,-1.067203,3.709291,4.371215,-1.067203,0,-6.045311,0.5373016,-1.063566,0,-4.259182,2.063219,-0.8911574,-0.8911574,4.570526e-17,-0.8911574,-1.143057,3.178687,-0.8911574,-0.4945103,5.042341,0.2706438,4.151183,3.178687,0.2706438,0,-6.806356,0.7831586,-0.8911574,0,-4.736438,1.008129,-0.7604017,-0.7604017,4.808482e-17,-0.7604017,0.03923215,4.352427,-0.7604017,-3.035028,4.85859,-0.9894763,4.098188,4.352427,-0.9894763,0,-5.128629,0.1221518,-0.7604017,0,-3.463478,1.504171,-0.3392428,-0.3392428,2.058072e-17,-0.3392428,-1.587071,4.183417,-0.3392428,-0.4992109,3.993065,-0.5648119,3.653822,4.183417,-0.5648119,0,-7.760171,0.529587,-0.3392428,0,-3.367928,0.6516227,-1.084844,-1.084844,5.463598e-17,-1.084844,-0.3318352,4.981655,-1.084844,-2.216753,4.616359,-0.3774612,3.531516,4.981655,-0.3774612,0,-7.061474,1.248431,-1.084844,0,-5.010771,1.088981,-0.8650535,-0.8650535,4.890939e-17,-0.8650535,-0.8455281,3.144656,-0.8650535,-1.416372,5.475908,-1.092192,4.610855,3.144656,-1.092192,0,-6.960739,0.4651377,-0.8650535,0,-5.395522,1.013137,-0.8741968,-0.8741968,4.97459e-17,-0.8741968,-0.5006066,2.843797,-0.8741968,-1.478511,5.156731,-0.8187351,4.282534,2.843797,-0.8187351,0,-6.009486,-0.2387907,-0.8741968,0,-3.654367,1.215036,-0.6621213,-0.6621213,4.637548e-17,-0.6621213,0.5881435,3.07811,-0.6621213,-2.149814,4.442985,-0.225751,3.780864,3.07811,-0.225751,0,-3.568103,0.7886185,-0.6621213,0,-4.666403,0.2409124,-0.9356391,-0.9356391,5.477452e-17,-0.9356391,-0.0654194,3.678696,-0.9356391,-1.015293,5.239902,-1.108555,4.304263,3.678696,-1.108555,0,-7.727812,0.5734988,-0.9356391,0,-4.339478,1.731858,-1.067979,-1.067979,4.704674e-17,-1.067979,-2.19367,3.204239,-1.067979,-1.274121,5.52118,0.05492929,4.453201,3.204239,0.05492929,0,-7.91311,1.181702,-1.067979,0,-4.788733,2.621476,-1.214386,-1.214386,4.902088e-17,-1.214386,-3.301004,2.514251,-1.214386,-2.137209,6.386656,-0.5135014,5.17227,2.514251,-0.5135014,0,-7.443225,1.597922,-1.214386,0,-4.254124,2.028326,-0.9272565,-0.9272565,5.16834e-17,-0.9272565,-0.2728364,4.66097,-0.9272565,-1.460075,4.931118,-0.05513415,4.003861,4.66097,-0.05513415,0,-6.376523,0.6769937,-0.9272565,0,-5.178446,1.228909,-1.063588,-1.063588,5.20582e-17,-1.063588,-1.71173,3.424723,-1.063588,-2.001163,5.952039,0.006006823,4.888451,3.424723,0.006006823,0,-7.858421,0.7735926,-1.063588,0,-4.950537,0.9097933,-0.9071637,-0.9071637,4.515589e-17,-0.9071637,-0.8797431,4.410946,-0.9071637,-1.334335,4.504476,0.182621,3.597313,4.410946,0.182621,0,-7.551038,-0.4460609,-0.9071637,0,-4.316468,1.621234,-0.895769,-0.895769,5.274453e-17,-0.895769,0.1239146,3.696777,-0.895769,-1.479597,4.845022,-0.8921603,3.949253,3.696777,-0.8921603,0,-5.317054,0.5285544,-0.895769,0,-4.341222,1.995998,-0.8753406,-0.8753406,4.045784e-17,-0.8753406,-2.211105,2.236642,-0.8753406,-1.448674,5.420468,-0.8591771,4.545127,2.236642,-0.8591771,0,-6.423542,1.079246,-0.8753406,0,-4.532967,1.439392,-0.901662,-0.901662,4.850396e-17,-0.901662,-1.212368,2.463916,-0.901662,-2.10498,5.624277,-0.2981155,4.722615,2.463916,-0.2981155,0,-5.756189,1.09131,-0.901662,0,-4.538094,1.406201,-0.9062246,-0.9062246,4.837896e-17,-0.9062246,-1.160346,3.205304,-0.9062246,-0.9660792,5.506007,-0.3261357,4.599782,3.205304,-0.3261357,0,-7.499376,0.9679128,-0.9062246,0,-5.090622,2.05926,-1.134522,-1.134522,5.68238e-17,-1.134522,-0.8422296,3.684799,-1.134522,-1.415076,5.382086,0.08708736,4.247564,3.684799,0.08708736,0,-6.434779,0.291464,-1.134522,0,-6.267527,1.879838,-1.20959,-1.20959,6.093791e-17,-1.20959,-1.538293,2.389454,-1.20959,-1.927314,6.607393,-0.2339716,5.397802,2.389454,-0.2339716,0,-6.727988,0.3398656,-1.20959,0,-4.055074,1.127282,-1.107051,-1.107051,5.308531e-17,-1.107051,-0.5790701,3.545974,-1.107051,-1.048633,4.475689,-1.015166,3.368638,3.545974,-1.015166,0,-6.424817,0.4206152,-1.107051,0,-4.208445,1.005247,-0.732143,-0.732143,4.543966e-17,-0.732143,0.08086859,4.538104,-0.732143,-0.6764324,4.452329,-0.9248103,3.720186,4.538104,-0.9248103,0,-7.227885,0.2438839,-0.732143,0,-4.585862,0.3677005,-0.8949504,-0.8949504,5.991859e-17,-0.8949504,0.937532,4.225051,-0.8949504,-2.457756,5.273605,-0.08773638,4.378655,4.225051,-0.08773638,0,-5.735667,0.6877436,-0.8949504,0,-3.851919,0.7809644,-0.7089811,-0.7089811,4.394039e-17,-0.7089811,-0.1332739,3.517191,-0.7089811,-2.617319,4.562849,-0.602066,3.853868,3.517191,-0.602066,0,-4.81503,0.7109294,-0.7089811,0,-4.746479,0.7433299,-0.5774087,-0.5774087,4.131553e-17,-0.5774087,-0.2055657,3.534782,-0.5774087,-2.206392,4.945159,-0.3736888,4.36775,3.534782,-0.3736888,0,-5.735785,0.1986797,-0.5774087,0,-4.663601,3.064578,-1.238848,-1.238848,5.641845e-17,-1.238848,-1.769188,3.668724,-1.238848,-0.6659189,5.807555,-0.6240741,4.568706,3.668724,-0.6240741,0,-7.51497,1.143954,-1.238848,0,-5.073065,1.28589,-1.234126,-1.234126,6.292914e-17,-1.234126,-0.6506505,3.353558,-1.234126,-2.694662,5.74738,-0.7333925,4.513253,3.353558,-0.7333925,0,-5.771037,0.6743147,-1.234126,0,-4.51759,0.8403409,-1.00103,-1.00103,5.354708e-17,-1.00103,-0.6943403,3.338644,-1.00103,-1.706512,5.371241,-0.7684263,4.370211,3.338644,-0.7684263,0,-6.857372,0.8536509,-1.00103,0,-5.717159,2.185102,-1.176947,-1.176947,4.826706e-17,-1.176947,-3.170177,3.260132,-1.176947,-2.597035,6.305334,-0.313912,5.128387,3.260132,-0.313912,0,-7.953506,0.5881748,-1.176947,0,-4.453115,0.9952254,-1.024373,-1.024373,5.101342e-17,-1.024373,-0.9854999,3.352157,-1.024373,-1.341756,5.081264,-0.04242609,4.056891,3.352157,-0.04242609,0,-7.081939,0.628149,-1.024373,0,-4.584663,1.463483,-0.8102199,-0.8102199,4.432115e-17,-0.8102199,-0.8625123,2.802644,-0.8102199,-2.11329,4.918589,-0.4463365,4.108369,2.802644,-0.4463365,0,-5.006972,0.3339257,-0.8102199,0,-4.594311,1.452075,-1.161776,-1.161776,5.435939e-17,-1.161776,-1.441668,3.42588,-1.161776,-1.686455,5.465947,-0.3793501,4.304171,3.42588,-0.3793501,0,-7.194965,0.8716361,-1.161776,0,-4.325926,2.257578,-1.115231,-1.115231,4.666671e-17,-1.115231,-2.338478,2.922691,-1.115231,-1.653814,5.331679,-1.14707,4.216448,2.922691,-1.14707,0,-6.681456,1.005753,-1.115231,0,-3.364537,0.497688,-0.4962637,-0.4962637,4.100374e-17,-0.4962637,0.505609,4.098186,-0.4962637,-1.634081,4.500798,-1.100345,4.004534,4.098186,-1.100345,0,-5.961605,1.136261,-0.4962637,0,-5.489392,1.582356,-0.6809069,-0.6809069,4.329789e-17,-0.6809069,-0.4358131,3.823936,-0.6809069,-1.573573,4.985803,-0.9282463,4.304896,3.823936,-0.9282463,0,-6.089622,-0.5035896,-0.6809069,0,-4.443705,1.782547,-0.6085981,-0.6085981,3.464721e-17,-0.6085981,-1.994618,3.273902,-0.6085981,-1.609667,5.644968,-0.5756726,5.03637,3.273902,-0.5756726,0,-7.521274,1.201264,-0.6085981,0,-3.729956,0.8539531,-0.7266464,-0.7266464,4.408192e-17,-0.7266464,0.3765026,3.961941,-0.7266464,-2.241407,3.8459,-1.258709,3.119253,3.961941,-1.258709,0,-4.335978,0.115944,-0.7266464,0,-4.281484,1.079619,-0.9436341,-0.9436341,5.438224e-17,-0.9436341,-0.05057639,3.695978,-0.9436341,-2.139136,5.093067,-0.1149068,4.149433,3.695978,-0.1149068,0,-5.620867,0.8115834,-0.9436341,0,-3.968623,1.617861,-0.8968329,-0.8968329,3.954643e-17,-0.8968329,-1.741698,3.817448,-0.8968329,-2.230292,4.519032,-0.60776,3.622199,3.817448,-0.60776,0,-6.230026,0.5504088,-0.8968329,0,-3.831671,0.9112399,-0.6208522,-0.6208522,3.684267e-17,-0.6208522,-0.7514039,3.903237,-0.6208522,-2.422538,4.459028,-0.9255581,3.838176,3.903237,-0.9255581,0,-5.779891,0.6273573,-0.6208522,0,-3.87075,1.839609,-0.9659832,-0.9659832,4.635932e-17,-0.9659832,-1.28206,3.475132,-0.9659832,-0.7569549,4.881361,-0.6687208,3.915378,3.475132,-0.6687208,0,-7.04199,1.010611,-0.9659832,0,-5.588745,3.232831,-1.11809,-1.11809,4.755076e-17,-1.11809,-3.058096,2.992802,-1.11809,-0.8350753,6.388095,-0.5297801,5.270005,2.992802,-0.5297801,0,-8.371087,0.7993503,-1.11809,0,-5.232299,1.454481,-0.985474,-0.985474,5.401257e-17,-0.985474,-0.8975464,3.617677,-0.985474,-2.064815,5.814567,-0.8631155,4.829093,3.617677,-0.8631155,0,-6.810495,0.5822685,-0.985474,0,-4.696692,1.068972,-0.4944392,-0.4944392,3.366544e-17,-0.4944392,-1.036002,3.613562,-0.4944392,-1.479977,4.963204,-0.7213164,4.468765,3.613562,-0.7213164,0,-7.063819,0.2665124,-0.4944392,0,-4.847158,1.195527,-0.7882056,-0.7882056,4.695246e-17,-0.7882056,-0.03860587,3.795793,-0.7882056,-1.492153,4.555783,-0.7142332,3.767577,3.795793,-0.7142332,0,-5.702501,-0.2913751,-0.7882056,0,-3.556352,1.735313,-0.723241,-0.723241,3.374869e-17,-0.723241,-1.741878,3.985513,-0.723241,-2.533868,4.436913,-1.105432,3.713672,3.985513,-1.105432,0,-5.895122,0.880561,-0.723241,0,-4.175676,0.9180028,-0.7999082,-0.7999082,5.10467e-17,-0.7999082,0.6132563,4.307494,-0.7999082,-1.63576,4.490933,-0.548311,3.691024,4.307494,-0.548311,0,-5.631407,0.315257,-0.7999082,0,-3.473937,1.069804,-0.6420596,-0.6420596,3.237208e-17,-0.6420596,-1.240527,4.328806,-0.6420596,-2.343195,4.040939,-0.7362786,3.398879,4.328806,-0.7362786,0,-6.197272,0.5670019,-0.6420596,0,-4.715902,1.078472,-0.8074439,-0.8074439,5.033802e-17,-0.8074439,0.03506457,3.991584,-0.8074439,-1.262617,5.022783,-1.245135,4.215339,3.991584,-1.245135,0,-6.638213,0.3068805,-0.8074439,0,-4.041458,0.9248944,-0.551974,-0.551974,4.076901e-17,-0.551974,-0.1152161,3.368548,-0.551974,-1.885127,4.881183,0.122998,4.329209,3.368548,0.122998,0,-5.554925,0.8397251,-0.551974,0,-5.411603,2.539534,-0.9590108,-0.9590108,4.672767e-17,-0.9590108,-2.111037,2.75731,-0.9590108,-1.338021,6.031886,-0.05509011,5.072875,2.75731,-0.05509011,0,-7.022678,0.6202824,-0.9590108,0,-4.774752,1.620056,-1.033495,-1.033495,5.041464e-17,-1.033495,-1.238258,3.284719,-1.033495,-0.6559991,5.219611,-1.493727,4.186116,3.284719,-1.493727,0,-7.466533,0.4448593,-1.033495,0,-5.01511,1.935756,-0.8701111,-0.8701111,4.393143e-17,-0.8701111,-1.855121,3.481436,-0.8701111,-1.028,5.705357,-0.6382729,4.835246,3.481436,-0.6382729,0,-8.078158,0.6902468,-0.8701111,0,-3.098676,1.531796,-1.040437,-1.040437,4.377275e-17,-1.040437,-1.557528,2.80565,-1.040437,-1.545433,4.243373,0.3231968,3.202936,2.80565,0.3231968,0,-5.529322,1.144697,-1.040437,0,-3.283584,1.160423,-0.7270564,-0.7270564,4.355762e-17,-0.7270564,-0.008005506,3.379441,-0.7270564,-1.221774,4.217582,-0.241283,3.490526,3.379441,-0.241283,0,-5.222832,0.9339985,-0.7270564,0,-4.504508,1.36611,-0.9056231,-0.9056231,5.057742e-17,-0.9056231,-0.3558982,3.868687,-0.9056231,-1.694063,4.94755,-0.7577489,4.041927,3.868687,-0.7577489,0,-6.111963,0.4430422,-0.9056231,0,-4.233411,1.285612,-0.9689649,-0.9689649,4.361507e-17,-0.9689649,-1.428232,3.662746,-0.9689649,-1.037924,4.495072,-0.5157508,3.526107,3.662746,-0.5157508,0,-7.262514,0.2616615,-0.9689649,0,-4.665226,2.163328,-1.064084,-1.064084,5.040904e-17,-1.064084,-1.609369,2.486891,-1.064084,-0.5895141,5.490864,-0.3756997,4.426779,2.486891,-0.3756997,0,-6.834281,0.8256371,-1.064084,0,-3.721541,0.9943646,-0.6451206,-0.6451206,3.904738e-17,-0.6451206,-0.4393375,3.707463,-0.6451206,-2.475801,4.360935,-0.2454042,3.715814,3.707463,-0.2454042,0,-5.03757,0.6393943,-0.6451206,0,-3.87232,2.291993,-0.9569178,-0.9569178,4.430888e-17,-0.9569178,-1.368628,2.898797,-0.9569178,-2.685576,4.634736,-0.3163864,3.677818,2.898797,-0.3163864,0,-3.924593,0.7624159,-0.9569178,0,-5.638575,1.74365,-1.414915,-1.414915,7.15957e-17,-1.414915,-0.06343381,3.673238,-1.414915,-1.410903,5.627901,1.454968,4.212986,3.673238,1.454968,0,-6.21002,-0.01067436,-1.414915,0,-5.085765,1.137061,-1.389678,-1.389678,6.622554e-17,-1.389678,-1.240859,3.549873,-1.389678,-1.736168,6.176352,-0.08876059,4.786674,3.549873,-0.08876059,0,-8.093856,1.090587,-1.389678,0,-3.823175,1.244995,-0.8501852,-0.8501852,4.655974e-17,-0.8501852,-0.9919622,2.681931,-0.8501852,-1.748774,5.280034,-0.3470713,4.429849,2.681931,-0.3470713,0,-5.960157,1.456859,-0.8501852,0,-4.045898,1.864014,-0.6859954,-0.6859954,3.739589e-17,-0.6859954,-1.508011,3.017602,-0.6859954,-1.700648,5.107918,-1.100283,4.421922,3.017602,-1.100283,0,-6.068868,1.062019,-0.6859954,0,-4.972944,1.210335,-0.8639806,-0.8639806,5.110885e-17,-0.8639806,-0.1752802,3.05667,-0.8639806,-2.824329,5.08787,-0.6073244,4.22389,3.05667,-0.6073244,0,-4.285157,0.1149266,-0.8639806,0,-3.85088,1.49018,-1.075254,-1.075254,5.179885e-17,-1.075254,-1.014932,2.881596,-1.075254,-0.7866148,4.958933,-0.7705454,3.883679,2.881596,-0.7705454,0,-6.578666,1.108053,-1.075254,0,-4.578217,2.215631,-0.7504649,-0.7504649,4.036285e-17,-0.7504649,-1.177161,3.264788,-0.7504649,-1.503713,4.889164,-0.4212456,4.138699,3.264788,-0.4212456,0,-5.61177,0.3109471,-0.7504649,0,-4.212015,1.338141,-0.7145259,-0.7145259,3.668371e-17,-0.7145259,-1.380021,3.900215,-0.7145259,-2.45107,4.628228,-1.194572,3.913702,3.900215,-1.194572,0,-6.119254,0.416213,-0.7145259,0 };
std::vector<double> CppRateResTest::beta_draws_cov_expected = { 0.4288628,-0.107379,0.07459704,0.07459704,-3.057965e-18,0.07459704,0.1199967,0.08583288,0.07459704,0.02783742,-0.2984972,-0.03925313,-0.2239002,0.08583288,-0.03925313,0,0.1974447,0.1303656,0.07459704,0,-0.107379,0.3285365,-0.04328023,-0.04328023,5.326212e-20,-0.04328023,-0.3515651,-0.1497116,-0.04328023,0.1028234,0.1797604,-0.003582608,0.1364801,-0.1497116,-0.003582608,0,-0.1559008,0.07238139,-0.04328023,0,0.07459704,-0.04328023,0.04738202,0.04738202,-1.5941e-18,0.04738202,0.0471579,0.02295485,0.04738202,0.01397501,-0.08358494,-0.02025084,-0.03620292,0.02295485,-0.02025084,0,0.05053275,-0.008987903,0.04738202,0,0.07459704,-0.04328023,0.04738202,0.04738202,-1.5941e-18,0.04738202,0.0471579,0.02295485,0.04738202,0.01397501,-0.08358494,-0.02025084,-0.03620292,0.02295485,-0.02025084,0,0.05053275,-0.008987903,0.04738202,0,-3.057965e-18,5.326212e-20,-1.5941e-18,-1.5941e-18,7.407081e-35,-1.5941e-18,1.693808e-18,1.401992e-19,-1.5941e-18,-1.172576e-18,2.819138e-18,9.931892e-19,1.225038e-18,1.401992e-19,9.931892e-19,0,-3.969033e-20,-2.388269e-19,-1.5941e-18,0,0.07459704,-0.04328023,0.04738202,0.04738202,-1.5941e-18,0.04738202,0.0471579,0.02295485,0.04738202,0.01397501,-0.08358494,-0.02025084,-0.03620292,0.02295485,-0.02025084,0,0.05053275,-0.008987903,0.04738202,0,0.1199967,-0.3515651,0.0471579,0.0471579,1.693808e-18,0.0471579,0.7096849,0.2469068,0.0471579,-0.101178,-0.2519383,0.03092463,-0.2047803,0.2469068,0.03092463,0,0.4643292,-0.1319415,0.0471579,0,0.08583288,-0.1497116,0.02295485,0.02295485,1.401992e-19,0.02295485,0.2469068,0.3205861,0.02295485,-0.08320124,-0.1369298,-0.01551193,-0.1139749,0.3205861,-0.01551193,0,-0.003259828,-0.05109692,0.02295485,0,0.07459704,-0.04328023,0.04738202,0.04738202,-1.5941e-18,0.04738202,0.0471579,0.02295485,0.04738202,0.01397501,-0.08358494,-0.02025084,-0.03620292,0.02295485,-0.02025084,0,0.05053275,-0.008987903,0.04738202,0,0.02783742,0.1028234,0.01397501,0.01397501,-1.172576e-18,0.01397501,-0.101178,-0.08320124,0.01397501,0.4538025,-0.02195677,0.004228135,-0.007981762,-0.08320124,0.004228135,0,-0.346999,0.005880653,0.01397501,0,-0.2984972,0.1797604,-0.08358494,-0.08358494,2.819138e-18,-0.08358494,-0.2519383,-0.1369298,-0.08358494,-0.02195677,0.3592114,0.03455226,0.2756265,-0.1369298,0.03455226,0,-0.2725027,0.0607142,-0.08358494,0,-0.03925313,-0.003582608,-0.02025084,-0.02025084,9.931892e-19,-0.02025084,0.03092463,-0.01551193,-0.02025084,0.004228135,0.03455226,0.2446508,0.01430142,-0.01551193,0.2446508,0,0.004073554,-0.004700868,-0.02025084,0,-0.2239002,0.1364801,-0.03620292,-0.03620292,1.225038e-18,-0.03620292,-0.2047803,-0.1139749,-0.03620292,-0.007981762,0.2756265,0.01430142,0.2394236,-0.1139749,0.01430142,0,-0.22197,0.0517263,-0.03620292,0,0.08583288,-0.1497116,0.02295485,0.02295485,1.401992e-19,0.02295485,0.2469068,0.3205861,0.02295485,-0.08320124,-0.1369298,-0.01551193,-0.1139749,0.3205861,-0.01551193,0,-0.003259828,-0.05109692,0.02295485,0,-0.03925313,-0.003582608,-0.02025084,-0.02025084,9.931892e-19,-0.02025084,0.03092463,-0.01551193,-0.02025084,0.004228135,0.03455226,0.2446508,0.01430142,-0.01551193,0.2446508,0,0.004073554,-0.004700868,-0.02025084,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1974447,-0.1559008,0.05053275,0.05053275,-3.969033e-20,0.05053275,0.4643292,-0.003259828,0.05053275,-0.346999,-0.2725027,0.004073554,-0.22197,-0.003259828,0.004073554,0,0.9311899,-0.07505805,0.05053275,0,0.1303656,0.07238139,-0.008987903,-0.008987903,-2.388269e-19,-0.008987903,-0.1319415,-0.05109692,-0.008987903,0.005880653,0.0607142,-0.004700868,0.0517263,-0.05109692,-0.004700868,0,-0.07505805,0.1910798,-0.008987903,0,0.07459704,-0.04328023,0.04738202,0.04738202,-1.5941e-18,0.04738202,0.0471579,0.02295485,0.04738202,0.01397501,-0.08358494,-0.02025084,-0.03620292,0.02295485,-0.02025084,0,0.05053275,-0.008987903,0.04738202,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
std::vector<double> CppRateResTest::f_draws_cov_expected = { 1.207364,-0.03326508,-0.06880209,0.1039112,0.0879779,0.1003496,-0.04040241,0.07662694,0.07041105,0.1124372,-0.03326508,0.9879858,-0.001279515,-0.03446579,-0.07153994,-0.03505865,-0.01802774,-0.08817906,0.1038828,0.001291054,-0.06880209,-0.001279515,0.8806739,0.03447434,0.08738902,0.01024292,0.1558718,-0.1004562,0.02177331,-0.087908,0.1039112,-0.03446579,0.03447434,1.012034,-0.1333072,-0.1174497,-0.07832237,-0.07313289,0.07866947,-0.06921293,0.0879779,-0.07153994,0.08738902,-0.1333072,0.9479248,0.001675407,-0.04922719,-0.06814477,-0.1314116,0.0009818912,0.1003496,-0.03505865,0.01024292,-0.1174497,0.001675407,1.123497,-0.1066625,0.1262912,-0.2969926,-0.03333363,-0.04040241,-0.01802774,0.1558718,-0.07832237,-0.04922719,-0.1066625,1.061945,-0.04609331,0.09290244,-0.1739056,0.07662694,-0.08817906,-0.1004562,-0.07313289,-0.06814477,0.1262912,-0.04609331,1.098213,-0.004211038,0.1501549,0.07041105,0.1038828,0.02177331,0.07866947,-0.1314116,-0.2969926,0.09290244,-0.004211038,0.9611315,0.07030553,0.1124372,0.001291054,-0.087908,-0.06921293,0.0009818912,-0.03333363,-0.1739056,0.1501549,0.07030553,0.9786032 };
std::vector<double> CppRateResTest::svd_cov_u_expected = { -0.135223,1.144834,0.8240781,0.8240781,-2.826026e-16,0.8240781,0.3321822,0.4545049,0.8240781,0.2847076,0.3433091,0.1601377,1.167387,0.4545049,0.1601377,0,0.3944946,0.2080861,0.8240781,0,-0.2358305,-1.220698,0.5584761,0.5584761,1.243812e-17,0.5584761,-0.7148296,-0.3735357,0.5584761,-0.7486961,-0.3758016,0.2193503,0.1826745,-0.3735357,0.2193503,0,-0.4374937,-0.6116321,0.5584761,0,0.5001594,-0.934062,0.02783916,0.02783916,-2.589061e-16,0.02783916,0.878083,-0.4142546,0.02783916,0.01233304,0.6684734,-0.1706707,0.6963125,-0.4142546,-0.1706707,0,-0.3225308,1.168633,0.02783916,0,0.6448512,0.1424702,-0.06480366,-0.06480366,2.835969e-16,-0.06480366,-0.5616716,0.3831712,-0.06480366,-0.7592622,0.03155448,0.5065485,-0.03324919,0.3831712,0.5065485,0,-0.07466483,0.6764057,-0.06480366,0,-0.07624609,0.04319508,0.000325751,0.000325751,-5.873296e-17,0.000325751,-0.2609925,0.2659553,0.000325751,-0.6324307,0.1378142,-0.8173514,0.1381399,0.2659553,-0.8173514,0,0.01086374,0.06156808,0.000325751,0,-0.5991783,-0.2202414,-0.1246822,-0.1246822,2.508105e-16,-0.1246822,0.3973871,0.3732488,-0.1246822,-0.3039344,0.3420615,0.2335598,0.2173793,0.3732488,0.2335598,0,-0.2342302,-0.2571169,-0.1246822,0,-0.245568,0.1503603,-0.07262108,-0.07262108,1.449384e-16,-0.07262108,-0.03861951,-0.3781881,-0.07262108,-0.4367353,0.235184,0.1051952,0.1625629,-0.3781881,0.1051952,0,0.6914802,-0.01038404,-0.07262108,0,0.177379,-0.2013572,0.05024486,0.05024486,-2.043965e-17,0.05024486,0.3540567,0.1484746,0.05024486,-0.1231845,-0.2362043,-0.009529465,-0.1859594,0.1484746,-0.009529465,0,0.3636137,-0.05882528,0.05024486,0 };
size_t CppRateResTest::svd_cov_u_invariant_dims = 8;
std::vector<double> CppRateResTest::col_means_beta_expected = { -4.443478,1.481216,-0.8958073,-0.8958073,4.66693e-17,-0.8958073,-1.042367,3.465682,-0.8958073,-1.620646,5.081105,-0.5907243,4.185298,3.465682,-0.5907243,0,-6.487291,0.6376266,-0.8958073,0 };
std::vector<double> CppRateResTest::lambda_expected = { 1.196489,-0.1862078,-0.1695769,-0.1695769,-9.635527e-17,-0.1695769,0.05472666,-0.05818686,-0.1695769,-0.02964715,0.08177842,0.06275502,-0.08779845,-0.05818686,0.06275502,0,-0.1254255,1.278267,-0.1695769,0,-0.1862078,3.807042,0.2329039,0.2329039,-8.834503e-17,0.2329039,0.1767855,1.260359,0.2329039,1.11894,0.2454126,0.07814661,0.4783164,1.260359,0.07814661,0,1.359116,0.0592048,0.2329039,0,-0.1695769,0.2329039,1.019319,1.019319,-2.943694e-16,1.019319,-0.09366569,0.118047,1.019319,-0.07074529,0.01805075,0.1793852,1.03737,0.118047,0.1793852,0,0.07388568,-0.1515261,1.019319,0,-0.1695769,0.2329039,1.019319,1.019319,-2.943694e-16,1.019319,-0.09366569,0.118047,1.019319,-0.07074529,0.01805075,0.1793852,1.03737,0.118047,0.1793852,0,0.07388568,-0.1515261,1.019319,0,-9.635527e-17,-8.834503e-17,-2.943694e-16,-2.943694e-16,3.152589e-31,-2.943694e-16,-3.872326e-16,1.029745e-16,-2.943694e-16,-4.081563e-16,-1.492039e-16,2.673426e-16,-4.435733e-16,1.029745e-16,2.673426e-16,0,-2.119189e-17,-2.455592e-16,-2.943694e-16,0,-0.1695769,0.2329039,1.019319,1.019319,-2.943694e-16,1.019319,-0.09366569,0.118047,1.019319,-0.07074529,0.01805075,0.1793852,1.03737,0.118047,0.1793852,0,0.07388568,-0.1515261,1.019319,0,0.05472666,0.1767855,-0.09366569,-0.09366569,-3.872326e-16,-0.09366569,2.060712,-0.01488769,-0.09366569,1.084583,0.9591771,-0.2392804,0.8655114,-0.01488769,-0.2392804,0,0.2086257,1.013904,-0.09366569,0,-0.05818686,1.260359,0.118047,0.118047,1.029745e-16,0.118047,-0.01488769,1.039649,0.118047,-0.02173387,0.07189591,0.08424262,0.1899429,1.039649,0.08424262,0,0.1556606,0.01370905,0.118047,0,-0.1695769,0.2329039,1.019319,1.019319,-2.943694e-16,1.019319,-0.09366569,0.118047,1.019319,-0.07074529,0.01805075,0.1793852,1.03737,0.118047,0.1793852,0,0.07388568,-0.1515261,1.019319,0,-0.02964715,1.11894,-0.07074529,-0.07074529,-4.081563e-16,-0.07074529,1.084583,-0.02173387,-0.07074529,1.916492,0.09865149,-0.1041797,0.0279062,-0.02173387,-0.1041797,0,0.2101126,0.06900434,-0.07074529,0,0.08177842,0.2454126,0.01805075,0.01805075,-1.492039e-16,0.01805075,0.9591771,0.07189591,0.01805075,0.09865149,0.9540431,-0.1313201,0.9720938,0.07189591,-0.1313201,0,0.07999916,1.035821,0.01805075,0,0.06275502,0.07814661,0.1793852,0.1793852,2.673426e-16,0.1793852,-0.2392804,0.08424262,0.1793852,-0.1041797,-0.1313201,1.093249,0.04806513,0.08424262,1.093249,0,-0.009876653,-0.06856504,0.1793852,0,-0.08779845,0.4783164,1.03737,1.03737,-4.435733e-16,1.03737,0.8655114,0.1899429,1.03737,0.0279062,0.9720938,0.04806513,2.009464,0.1899429,0.04806513,0,0.1538848,0.8842954,1.03737,0,-0.05818686,1.260359,0.118047,0.118047,1.029745e-16,0.118047,-0.01488769,1.039649,0.118047,-0.02173387,0.07189591,0.08424262,0.1899429,1.039649,0.08424262,0,0.1556606,0.01370905,0.118047,0,0.06275502,0.07814661,0.1793852,0.1793852,2.673426e-16,0.1793852,-0.2392804,0.08424262,0.1793852,-0.1041797,-0.1313201,1.093249,0.04806513,0.08424262,1.093249,0,-0.009876653,-0.06856504,0.1793852,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.1254255,1.359116,0.07388568,0.07388568,-2.119189e-17,0.07388568,0.2086257,0.1556606,0.07388568,0.2101126,0.07999916,-0.009876653,0.1538848,0.1556606,-0.009876653,0,1.121969,-0.04542636,0.07388568,0,1.278267,0.0592048,-0.1515261,-0.1515261,-2.455592e-16,-0.1515261,1.013904,0.01370905,-0.1515261,0.06900434,1.035821,-0.06856504,0.8842954,0.01370905,-0.06856504,0,-0.04542636,2.314089,-0.1515261,0,-0.1695769,0.2329039,1.019319,1.019319,-2.943694e-16,1.019319,-0.09366569,0.118047,1.019319,-0.07074529,0.01805075,0.1793852,1.03737,0.118047,0.1793852,0,0.07388568,-0.1515261,1.019319,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
std::vector<double> CppRateResTest::sherman_r_expected = { 1.194607,-0.1483072,-0.170206,-0.170206,-9.615463e-17,-0.170206,0.04609308,-0.05372744,-0.170206,-0.020629,0.08559477,0.06275502,-0.08462315,-0.05372744,0.06275502,0,-0.1164074,1.280167,-0.170206,0,-0.151049,3.303529,0.2445113,0.2445113,-9.202349e-17,0.2445113,0.3500671,1.182102,0.2445113,0.9673163,0.1780246,0.07814661,0.4218986,1.182102,0.07814661,0,1.207492,0.02503628,0.2445113,0,-0.1702058,0.2448688,1.019109,1.019109,-2.943025e-16,1.019109,-0.09658065,0.1195238,1.019109,-0.06777868,0.01931575,0.1793852,1.038423,0.1195238,0.1793852,0,0.07685229,-0.1508948,1.019109,0,-0.1702058,0.2448688,1.019109,1.019109,-2.943025e-16,1.019109,-0.09658065,0.1195238,1.019109,-0.06777868,0.01931575,0.1793852,1.038423,0.1195238,0.1793852,0,0.07685229,-0.1508948,1.019109,0,-9.615463e-17,-9.202349e-17,-2.943025e-16,-2.943025e-16,3.152376e-31,-2.943025e-16,-3.862962e-16,1.025063e-16,-2.943025e-16,-4.090926e-16,-1.496052e-16,2.673426e-16,-4.439077e-16,1.025063e-16,2.673426e-16,0,-2.212823e-17,-2.457598e-16,-2.943025e-16,0,-0.1702058,0.2448688,1.019109,1.019109,-2.943025e-16,1.019109,-0.09658065,0.1195238,1.019109,-0.06777868,0.01931575,0.1793852,1.038423,0.1195238,0.1793852,0,0.07685229,-0.1508948,1.019109,0,0.0460378,0.4014842,-0.09659134,-0.09659134,-3.862962e-16,-0.09659134,2.022286,0.006457522,-0.09659134,1.128913,0.9773768,-0.2392804,0.8805985,0.006457522,-0.2392804,0,0.2529557,1.022862,-0.09659134,0,-0.05380455,1.168536,0.1195141,0.1195141,1.025063e-16,0.1195141,0.005089394,1.029198,0.1195141,-0.04296263,0.06295787,0.08424262,0.1825109,1.029198,0.08424262,0,0.1344319,0.00926931,0.1195141,0,-0.1702058,0.2448688,1.019109,1.019109,-2.943025e-16,1.019109,-0.09658065,0.1195238,1.019109,-0.06777868,0.01931575,0.1793852,1.038423,0.1195238,0.1793852,0,0.07685229,-0.1508948,1.019109,0,-0.02078586,0.9694606,-0.06780034,-0.06780034,-4.090926e-16,-0.06780034,1.126628,-0.04210528,-0.06780034,1.876166,0.08116449,-0.1041797,0.01331215,-0.04210528,-0.1041797,0,0.1697861,0.06022192,-0.06780034,0,0.08558892,0.1847864,0.01931428,0.01931428,-1.496052e-16,0.01931428,0.9774883,0.06323222,0.01931428,0.081629,0.946598,-0.1313201,0.9658736,0.06323222,-0.1313201,0,0.06297667,1.03207,0.01931428,0,0.06275502,0.07814661,0.1793852,0.1793852,2.673426e-16,0.1793852,-0.2392804,0.08424262,0.1793852,-0.1041797,-0.1313201,1.093249,0.04806513,0.08424262,1.093249,0,-0.009876653,-0.06856504,0.1793852,0,-0.08462905,0.4262227,1.038422,1.038422,-4.439077e-16,1.038422,0.8806329,0.1826919,1.038422,0.01359958,0.9658665,0.04806513,2.004264,0.1826919,0.04806513,0,0.1395782,0.8811634,1.038422,0,-0.05380455,1.168536,0.1195141,0.1195141,1.025063e-16,0.1195141,0.005089394,1.029198,0.1195141,-0.04296263,0.06295787,0.08424262,0.1825109,1.029198,0.08424262,0,0.1344319,0.00926931,0.1195141,0,0.06275502,0.07814661,0.1793852,0.1793852,2.673426e-16,0.1793852,-0.2392804,0.08424262,0.1793852,-0.1041797,-0.1313201,1.093249,0.04806513,0.08424262,1.093249,0,-0.009876653,-0.06856504,0.1793852,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.1166632,1.174435,0.0768196,0.0768196,-2.212823e-17,0.0768196,0.2485313,0.1347459,0.0768196,0.1676,0.06211334,-0.009876653,0.139014,0.1347459,-0.009876653,0,1.079457,-0.05430824,0.0768196,0,1.280164,0.02643867,-0.1508953,-0.1508953,-2.457598e-16,-0.1508953,1.022857,0.009330362,-0.1508953,0.06031034,1.032064,-0.06856504,0.8811612,0.009330362,-0.06856504,0,-0.05412035,2.312204,-0.1508953,0,-0.1702058,0.2448688,1.019109,1.019109,-2.943025e-16,1.019109,-0.09658065,0.1195238,1.019109,-0.06777868,0.01931575,0.1793852,1.038423,0.1195238,0.1793852,0,0.07685229,-0.1508948,1.019109,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
std::vector<double> CppRateResTest::expected_KLD = { 46.7013731559339, 18.0326943349702, 11.3476008015389, 11.3476008015389, 0.0, 11.3476008015389, 6.92892677441328, 68.0601282048986, 11.3476008015389, 11.1261904144762, 153.373975215714, 0.439287705790222, 296.568244722871, 68.0601282048987, 0.439287705790222, 0, 205.01033657952, 1.93746322665465, 11.3476008015389, 0.0 };
std::vector<double> CppRateResTest::expected_RATE = { 0.0500327518940475, 0.0193190319828556, 0.0121570664228735, 0.0121570664228735, 0.0, 0.0121570664228735, 0.00742319231254111, 0.0729151045940945, 0.0121570664228735, 0.011919862027926, 0.164314698485404, 0.000470623694950496, 0.317723535843982, 0.0729151045940946, 0.000470623694950496, 0.0, 0.219634469238193, 0.00207566952259381, 0.0121570664228735, 0.0 };
double CppRateResTest::expected_ESS = 49.5899195201055;
double CppRateResTest::expected_Delta = 1.01653886450565;
std::vector<double> CppRateResTest::project_cov_f_draws_expected = { 0.1633038,-0.01592649,-0.01555945,0.01274037,0.02518951,0.01992711,0.02975582,-0.01592649,0.1891816,-0.006925335,0.01381648,-0.02203459,-0.02060443,0.04528158,-0.01555945,-0.006925335,0.2261098,-0.003619846,0.06239308,0.0636921,0.06404139,0.01274037,0.01381648,-0.003619846,0.4224994,-0.0391472,0.01083324,0.05879748,0.02518951,-0.02203459,0.06239308,-0.0391472,0.4893016,0.0482919,0.06091409,0.01992711,-0.02060443,0.0636921,0.01083324,0.0482919,0.68823,-0.03916205,0.02975582,0.04528158,0.06404139,0.05879748,0.06091409,-0.03916205,0.8243636 };
std::vector<double> CppRateResTest::svd_project_cov_f_draws_u = { -0.2670473,-0.6097987,0.06226364,0.6480813,-0.5021933,0.1592939,-0.2081234,-0.03034532,0.115043,0.9263569,-0.07799005,-0.1275088,-0.00210895,-0.05591903,-0.02308919,-0.07799005,-0.1275088,-0.00210895,-0.05591903,-0.02308919,1.819947e-31,-1.316678e-30,4.146129e-31,2.69245e-31,-2.332002e-31,-0.07799005,-0.1275088,-0.00210895,-0.05591903,-0.02308919,-0.05268844,0.3757277,0.2428562,-0.5061691,-0.873049,-0.3841917,0.3626369,-0.2854429,0.3928255,0.4136347,-0.07799005,-0.1275088,-0.00210895,-0.05591903,-0.02308919,-0.4266934,-0.2736765,0.6626513,-0.7623395,-0.01456461,0.2545797,0.353803,-0.1279772,0.006469931,-0.6725625,0.1098059,0.2341973,0.8010913,0.5313232,0.1717568,0.1765897,0.2262943,-0.1300862,-0.0494491,-0.6956517,-0.3841917,0.3626369,-0.2854429,0.3928255,0.4136347,0.1098059,0.2341973,0.8010913,0.5313232,0.1717568,0,0,0,0,0,0.6629108,-0.2751592,-0.03672019,-0.02808204,0.3268003,-0.01246751,-0.2559957,-0.06571359,0.6545513,-1.174756,-0.07799005,-0.1275088,-0.00210895,-0.05591903,-0.02308919,0,0,0,0,0 };
std::vector<double> CppRateResTest::approximate_cov_beta_expected = { 0.3186096,0.03013714,0.04294207,0.04294207,0,0.04294207,-0.1265103,-0.01109893,0.04294207,0.1111653,-0.1433531,-0.0363708,-0.100411,-0.01109893,-0.0363708,0,-0.05308641,0.1752565,0.04294207,0,0.03013714,0.1618613,-0.003625886,-0.003625886,0,-0.003625886,-0.05449223,-0.03017284,-0.003625886,-0.0002961449,-0.01037521,-0.00778191,-0.0140011,-0.03017284,-0.00778191,0,0.1482133,0.01976193,-0.003625886,0,0.04294207,-0.003625886,0.03829962,0.03829962,0,0.03829962,-0.02398566,-0.004923696,0.03829962,0.03792824,-0.03892167,-0.01944473,-0.0006220569,-0.004923696,-0.01944473,0,-0.02169441,0.0040204,0.03829962,0,0.04294207,-0.003625886,0.03829962,0.03829962,0,0.03829962,-0.02398566,-0.004923696,0.03829962,0.03792824,-0.03892167,-0.01944473,-0.0006220569,-0.004923696,-0.01944473,0,-0.02169441,0.0040204,0.03829962,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.04294207,-0.003625886,0.03829962,0.03829962,0,0.03829962,-0.02398566,-0.004923696,0.03829962,0.03792824,-0.03892167,-0.01944473,-0.0006220569,-0.004923696,-0.01944473,0,-0.02169441,0.0040204,0.03829962,0,-0.1265103,-0.05449223,-0.02398566,-0.02398566,0,-0.02398566,0.1808147,0.03310433,-0.02398566,0.08338492,0.08770712,0.03866464,0.06372147,0.03310433,0.03866464,0,-0.07787395,-0.03880318,-0.02398566,0,-0.01109893,-0.03017284,-0.004923696,-0.004923696,0,-0.004923696,0.03310433,0.2357489,-0.004923696,-0.01017009,-0.001478817,-0.01280802,-0.006402514,0.2357489,-0.01280802,0,-0.2211685,-0.01257775,-0.004923696,0,0.04294207,-0.003625886,0.03829962,0.03829962,0,0.03829962,-0.02398566,-0.004923696,0.03829962,0.03792824,-0.03892167,-0.01944473,-0.0006220569,-0.004923696,-0.01944473,0,-0.02169441,0.0040204,0.03829962,0,0.1111653,-0.0002961449,0.03792824,0.03792824,0,0.03792824,0.08338492,-0.01017009,0.03792824,0.3909609,-0.1386466,0.001948291,-0.1007184,-0.01017009,0.001948291,0,-0.1590554,-0.02748133,0.03792824,0,-0.1433531,-0.01037521,-0.03892167,-0.03892167,0,-0.03892167,0.08770712,-0.001478817,-0.03892167,-0.1386466,0.143245,0.03007586,0.1043234,-0.001478817,0.03007586,0,0.07421231,-0.0001080678,-0.03892167,0,-0.0363708,-0.00778191,-0.01944473,-0.01944473,0,-0.01944473,0.03866464,-0.01280802,-0.01944473,0.001948291,0.03007586,0.2446508,0.01063114,-0.01280802,0.2446508,0,0.01166659,-0.006294934,-0.01944473,0,-0.100411,-0.0140011,-0.0006220569,-0.0006220569,0,-0.0006220569,0.06372147,-0.006402514,-0.0006220569,-0.1007184,0.1043234,0.01063114,0.1037013,-0.006402514,0.01063114,0,0.0525179,0.003912332,-0.0006220569,0,-0.01109893,-0.03017284,-0.004923696,-0.004923696,0,-0.004923696,0.03310433,0.2357489,-0.004923696,-0.01017009,-0.001478817,-0.01280802,-0.006402514,0.2357489,-0.01280802,0,-0.2211685,-0.01257775,-0.004923696,0,-0.0363708,-0.00778191,-0.01944473,-0.01944473,0,-0.01944473,0.03866464,-0.01280802,-0.01944473,0.001948291,0.03007586,0.2446508,0.01063114,-0.01280802,0.2446508,0,0.01166659,-0.006294934,-0.01944473,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.05308641,0.1482133,-0.02169441,-0.02169441,0,-0.02169441,-0.07787395,-0.2211685,-0.02169441,-0.1590554,0.07421231,0.01166659,0.0525179,-0.2211685,0.01166659,0,0.376351,0.0211259,-0.02169441,0,0.1752565,0.01976193,0.0040204,0.0040204,0,0.0040204,-0.03880318,-0.01257775,0.0040204,-0.02748133,-0.0001080678,-0.006294934,0.003912332,-0.01257775,-0.006294934,0,0.0211259,0.1751484,0.0040204,0,0.04294207,-0.003625886,0.03829962,0.03829962,0,0.03829962,-0.02398566,-0.004923696,0.03829962,0.03792824,-0.03892167,-0.01944473,-0.0006220569,-0.004923696,-0.01944473,0,-0.02169441,0.0040204,0.03829962,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };
std::vector<double> CppRateResTest::approximate_beta_means_expected = { -3.068615,-0.5218365,-0.5112928,-0.5112928,0,-0.5112928,2.649589,4.755439,-0.5112928,-2.708124,2.945878,-0.5907243,2.434586,4.755439,-0.5907243,0,-2.865441,-0.1227369,-0.5112928,0 };
std::vector<double> CppRateResTest::lowrank_lambda_expected = { 1.119253,-0.3081681,0.07380555,0.07380555,1.071727e-30,0.07380555,-0.08952623,-0.08945255,0.07380555,-0.1646498,0.05024764,0.1358278,0.1240532,-0.08945255,0.1358278,0,-0.1938395,1.169501,0.07380555,0,-0.3081681,0.9409827,-0.01364372,-0.01364372,1.053888e-31,-0.01364372,-0.9609464,0.3003544,-0.01364372,-0.1323134,-0.6514867,0.1646732,-0.6651305,0.3003544,0.1646732,0,0.4634821,-0.9596548,-0.01364372,0,0.07380555,-0.01364372,0.02600543,0.02600543,1.431483e-31,0.02600543,0.004150915,-0.04719118,0.02600543,0.1097421,-0.04953064,-0.07379224,-0.02352521,-0.04719118,-0.07379224,0,-0.02251304,0.02427491,0.02600543,0,0.07380555,-0.01364372,0.02600543,0.02600543,1.431483e-31,0.02600543,0.004150915,-0.04719118,0.02600543,0.1097421,-0.04953064,-0.07379224,-0.02352521,-0.04719118,-0.07379224,0,-0.02251304,0.02427491,0.02600543,0,1.071727e-30,1.053888e-31,1.431483e-31,1.431483e-31,2.065543e-60,1.431483e-31,-3.362985e-31,-6.564387e-31,1.431483e-31,3.555721e-31,-3.139899e-31,1.467667e-31,-1.708416e-31,-6.564387e-31,1.467667e-31,0,3.839468e-31,7.577371e-31,1.431483e-31,0,0.07380555,-0.01364372,0.02600543,0.02600543,1.431483e-31,0.02600543,0.004150915,-0.04719118,0.02600543,0.1097421,-0.04953064,-0.07379224,-0.02352521,-0.04719118,-0.07379224,0,-0.02251304,0.02427491,0.02600543,0,-0.08952623,-0.9609464,0.004150915,0.004150915,-3.362985e-31,0.004150915,1.221348,-0.4727859,0.004150915,0.4791713,0.6723452,-0.1421325,0.6764962,-0.4727859,-0.1421325,0,-0.4183288,0.582819,0.004150915,0,-0.08945255,0.3003544,-0.04719118,-0.04719118,-6.564387e-31,-0.04719118,-0.4727859,0.685992,-0.04719118,-0.4299531,-0.2086288,0.09383815,-0.25582,0.685992,0.09383815,0,-0.2198416,-0.2980813,-0.04719118,0,0.07380555,-0.01364372,0.02600543,0.02600543,1.431483e-31,0.02600543,0.004150915,-0.04719118,0.02600543,0.1097421,-0.04953064,-0.07379224,-0.02352521,-0.04719118,-0.07379224,0,-0.02251304,0.02427491,0.02600543,0,-0.1646498,-0.1323134,0.1097421,0.1097421,3.555721e-31,0.1097421,0.4791713,-0.4299531,0.1097421,1.277446,-0.285396,0.01234617,-0.175654,-0.4299531,0.01234617,0,-0.2152395,-0.4500459,0.1097421,0,0.05024764,-0.6514867,-0.04953064,-0.04953064,-3.139899e-31,-0.04953064,0.6723452,-0.2086288,-0.04953064,-0.285396,0.6587478,-0.1037869,0.6092171,-0.2086288,-0.1037869,0,-0.1438645,0.7089954,-0.04953064,0,0.1358278,0.1646732,-0.07379224,-0.07379224,1.467667e-31,-0.07379224,-0.1421325,0.09383815,-0.07379224,0.01234617,-0.1037869,1.020458,-0.1775791,0.09383815,1.020458,0,0.02014325,0.03204088,-0.07379224,0,0.1240532,-0.6651305,-0.02352521,-0.02352521,-1.708416e-31,-0.02352521,0.6764962,-0.25582,-0.02352521,-0.175654,0.6092171,-0.1775791,0.5856919,-0.25582,-0.1775791,0,-0.1663775,0.7332703,-0.02352521,0,-0.08945255,0.3003544,-0.04719118,-0.04719118,-6.564387e-31,-0.04719118,-0.4727859,0.685992,-0.04719118,-0.4299531,-0.2086288,0.09383815,-0.25582,0.685992,0.09383815,0,-0.2198416,-0.2980813,-0.04719118,0,0.1358278,0.1646732,-0.07379224,-0.07379224,1.467667e-31,-0.07379224,-0.1421325,0.09383815,-0.07379224,0.01234617,-0.1037869,1.020458,-0.1775791,0.09383815,1.020458,0,0.02014325,0.03204088,-0.07379224,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.1938395,0.4634821,-0.02251304,-0.02251304,3.839468e-31,-0.02251304,-0.4183288,-0.2198416,-0.02251304,-0.2152395,-0.1438645,0.02014325,-0.1663775,-0.2198416,0.02014325,0,0.6240988,-0.337704,-0.02251304,0,1.169501,-0.9596548,0.02427491,0.02427491,7.577371e-31,0.02427491,0.582819,-0.2980813,0.02427491,-0.4500459,0.7089954,0.03204088,0.7332703,-0.2980813,0.03204088,0,-0.337704,1.878496,0.02427491,0,0.07380555,-0.01364372,0.02600543,0.02600543,1.431483e-31,0.02600543,0.004150915,-0.04719118,0.02600543,0.1097421,-0.04953064,-0.07379224,-0.02352521,-0.04719118,-0.07379224,0,-0.02251304,0.02427491,0.02600543,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 };

#endif
